(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["EmployeeInfo"],{1148:function(e,t,r){"use strict";var o=r("a691"),n=r("1d80");e.exports="".repeat||function(e){var t=String(n(this)),r="",s=o(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},"13d5":function(e,t,r){"use strict";var o=r("23e7"),n=r("d58f").left,s=r("a640"),i=r("ae40"),u=s("reduce"),a=i("reduce",{1:0});o({target:"Array",proto:!0,forced:!u||!a},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"246e":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("setEmployeesHours")],1)},n=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"wrapper littleMargin"},[r("div",{staticClass:"littleMargin"},[r("v-row",{attrs:{id:"mossadHoursDetails"}},[r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("מוסד - "+e._s(e._mossadInfo.mossadName))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("שעות מאוישות - "+e._s(e._mossadInfo.currHours))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("יתרת שעות - "+e._s(e._mossadInfo.maxHours-e._mossadInfo.currHours))])]),r("v-col",{attrs:{cols:"12",md:"3"}},[r("p",[e._v("כמות שעות מקסימלית - "+e._s(e._mossadInfo.maxHours))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("אחוז איוש - "+e._s(e.getTwoDigits(e._mossadInfo.currHours,e._mossadInfo.maxHours))+"%")])])],1),r("v-row",{attrs:{id:"serchEmployee"}},[r("v-col",{attrs:{cols:"12",md:"8"}},[r("v-card-text",[r("v-autocomplete",{attrs:{items:e.tzArray,color:"indigo lighten-5","hide-selected":"","item-text":function(e){return e.firstName+" "+e.lastName+" - "+e.empId},"item-value":"empId",label:"תעודת זהות",placeholder:"חפש"},on:{change:function(t){return e.getEmployeeInfo()}},model:{value:e.empId,callback:function(t){e.empId=t},expression:"empId"}})],1)],1)],1),Object.keys(this.employeeInfo).length>0?r("v-row",{staticClass:"second"},[r("v-col",{staticClass:"test",attrs:{cols:"12",md:"2"}},[r("p",[e._v("שם פרטי")]),e._v(" "+e._s(e.employeeInfo.firstName)+" ")]),r("v-col",{staticClass:"test",attrs:{cols:"12",md:"2"}},[r("p",[e._v("שם משפחה")]),e._v(" "+e._s(e.employeeInfo.lastName)+" ")]),r("v-col",{staticClass:"test",attrs:{cols:"12",md:"1"}},[r("p",[e._v("גיל")]),e._v(" "+e._s(e.formatDate)+" ")]),r("v-col",{staticClass:"test",attrs:{cols:"12",md:"1"}},[r("p",[e._v("מין")]),e._v(" "+e._s(e.formatGender)+" ")]),r("v-col",{staticClass:"test",attrs:{cols:"12",md:"1"}},[r("p",[e._v("משרת אם")]),e._v(" "+e._s(e.formatIsMother)+" ")]),r("v-col",{staticClass:"test",attrs:{cols:"12",md:"1"}},[r("p",[e._v("שעות גיל")]),e._v(" "+e._s(e.ageHours)+" ")]),r("v-col",{attrs:{cols:"12",md:"4"}},[Object.keys(this.existHours).length>0?r("table",{attrs:{id:"detailsTable"}},[r("thead",[r("th"),r("th",[e._v("א")]),r("th",[e._v("ב")]),r("th",[e._v("ג")]),r("th",[e._v("ד")]),r("th",[e._v("ה")]),r("th",[e._v("ו")]),r("th",[e._v("סיכום")])]),r("tbody",e._l(e.existHours,(function(t,o){return r("tr",{key:o},[r("td",[e._v(e._s(e.getRowType(t.type)))]),e._l(t.week,(function(t,o){return r("td",{key:o},[e._v(e._s(t))])})),r("td",[e._v(e._s(e.totalHours(t.week)))])],2)})),0)]):e._e()])],1):e._e(),null!=e.empId?r("v-row",[r("v-col",{attrs:{cols:"12",md:"2"}},[r("v-select",{attrs:{items:e.reformTypes,"item-text":"name","item-value":"reformId",label:"בחר רפורמה","single-line":""},model:{value:e.reformId,callback:function(t){e.reformId=t},expression:"reformId"}})],1)],1):e._e(),null!=e.employeeInfo&&null!=e.reformId?r("v-card",[r("v-card",{staticClass:"center"},[r("weeklyHours",{attrs:{empId:e.empId,reformType:e.reformId}})],1)],1):e._e()],1)])},i=[],u=(r("13d5"),r("b680"),r("bc3a")),a=r.n(u),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!=e.empId?r("div",{staticClass:"wrapper"},[r("h1",{attrs:{id:"centerize"}},[e._v(e._s(e._reformDiscription))]),r("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.reformType,expression:"reformType != 0"}],staticClass:"wrapper"},[r("div",[r("table",{staticClass:"table",attrs:{id:"t01"}},[e._m(0),r("tbody",[e._l(e.newHours,(function(t,o){return r("tr",{key:o},[r("td",[t.type==e.frontalConst&&0!=o?r("a",{on:{click:function(t){return e.removeRow(o)}}},[e._v("הסר")]):e._e()]),r("td",[e._v(e._s(e.convertReformDescription(t.type)))]),r("td",{attrs:{id:"autocomlete"}},[t.type==e.frontalConst?r("v-autocomplete",{attrs:{items:e._filteredCodes,"hide-no-data":"","hide-selected":"","item-text":function(e){return e.code+"-"+e.codeDescription},"item-value":"code"},on:{change:function(r){return e.setPrivateAndPauseCodes(t.code)}},model:{value:t.code,callback:function(r){e.$set(t,"code",r)},expression:"row.code"}}):e._e(),r("p",[e._v(e._s(t.code))])],1),r("td",{staticClass:"frontalStyle"},[e._v(e._s(e.currCodeDescription(t.code)))]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.hours,expression:"row.hours"}],attrs:{id:"hours",type:"number",disabled:t.code<=0||t.type!=e.frontalConst},domProps:{value:t.hours},on:{input:[function(r){r.target.composing||e.$set(t,"hours",r.target.value)},function(t){return e.getPauseAndPrivateHours()}]}})]),r("td",{staticClass:"frontalStyle"}),e._l(t.week,(function(o,n){return r("td",{key:n},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.week[n],expression:"row.week[index2]"}],attrs:{type:"number",disabled:t.hours<=0},domProps:{value:t.week[n]},on:{input:function(r){r.target.composing||e.$set(t.week,n,r.target.value)}}})])})),r("td",{style:{color:0==e.validRowsHours(t)?"red":"inherit"}},[e._v(e._s(e.rowSum(t.week)))])],2)})),r("tr",{staticClass:"summaryRow"},[r("td"),r("td",[e._v("סך")]),r("td",[e._v("--")]),r("td",[e._v("--")]),r("td",[e._v(e._s(e.hoursAmount()))]),r("td",[e._v(e._s(e.currOptionjobPercent(e.getAllFrontalHours()))+"%")]),e._l(parseInt(6),(function(t,o){return r("td",{key:o},[e._v(e._s(e.dayAmount(t-1)))])})),r("td",{style:{color:0==e.validTotalHours()?"red":"inherit"}},[e._v(e._s(e.tableSum()))])],2)],2)]),r("v-btn",{staticClass:"myBtn",attrs:{color:"success"},on:{click:function(t){return e.addNewRow()}}},[e._v("הוסף שורה")]),r("v-btn",{staticClass:"myBtn",attrs:{color:"info"},on:{click:function(t){return e.saveHours()}}},[e._v("שמור שעות")]),r("v-btn",{staticClass:"myBtn",attrs:{color:"red"},on:{click:function(t){return e.initilizer()}}},[e._v("נקה")])],1)])]):e._e()},d=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th"),r("th",[e._v("סוג")]),r("th",[e._v("קוד פיצול")]),r("th",[e._v("תיאור קוד פיצול")]),r("th",[e._v("שעות")]),r("th",[e._v("אחוז משרה")]),r("th",[e._v("א'")]),r("th",[e._v("ב'")]),r("th",[e._v("ג'")]),r("th",[e._v("ד'")]),r("th",[e._v("ה'")]),r("th",[e._v("ו'")]),r("th",[e._v("סך הכל")])])])}],l=(r("4de4"),r("7db0"),r("4160"),r("a434"),r("b0c0"),r("159b"),r("96cf"),r("1da1")),f=1,p=2,h=3,m={name:"weeklyHours",props:["empId","reformType"],data:function(){return{newHours:[],tableToSave:[],empOptions:[],reformTypes:[],codeDescription:[],existHours:[],frontalConst:f}},created:function(){this.initilizer(),this.getCodeDescription(),this.getReformTypes(),this.getEmployeeOptions(),this.getExistData()},methods:{getPauseAndPrivateHours:function(){var e=this.newHours.filter((function(e){return e.type==f})).reduce((function(e,t){return e+parseInt(t.hours)}),0);this.newHours.find((function(e){return e.type==h})).hours=this.empOptions.find((function(t){return t.frontalHours==e})).pauseHours,this.newHours.find((function(e){return e.type==p})).hours=this.empOptions.find((function(t){return t.frontalHours==e})).privateHours},getCodeDescription:function(){var e=this;a.a.get("/convertHours/byReform",{params:{reformType:this.reformType}}).then((function(t){e.codeDescription=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getReformTypes:function(){var e=this;a.a.get("/reformTypes/relevant").then((function(t){e.reformTypes=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getEmployeeOptions:function(){var e=this;a.a.get("/calcHours/options",{params:{reformType:this.reformType,empId:this.empId}}).then((function(t){e.empOptions=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getExistData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a.a.get("/teacherEmploymentDetails/byReform",{params:{empId:e.empId,mossadId:13,reformType:e.reformType}}).then((function(t){e.existHours=t.data,null!=e.existHours&&e.setExistHours()})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}));case 1:case"end":return t.stop()}}),t)})))()},setNewHoursForSave:function(){var e=this;this.tableToSave=[],this.newHours.forEach((function(t){t.week.forEach((function(r,o){e.tableToSave.push({empId:e.empId,mossadId:13,empCode:t.code,day:o,hours:r})}))}))},setPrivateAndPauseCodes:function(e){5466==e||5474==e?(this.newHours.find((function(e){return e.type==h})).code=5468,this.newHours.find((function(e){return e.type==p})).code=5467):3566==e?(this.newHours.find((function(e){return e.type==p})).code=3567,this.newHours.find((function(e){return e.type==h})).code=3568):9600==e||9617==e||9619==e||9620==e||9624==e||9626==e||9631==e||9670==e||9675==e?(this.newHours.find((function(e){return e.type==p})).code=9601,this.newHours.find((function(e){return e.type==h})).code=9602):3900==e||3917==e||3971==e?(this.newHours.find((function(e){return e.type==p})).code=3901,this.newHours.find((function(e){return e.type==h})).code=3902):(this.newHours.find((function(e){return e.type==p})).code="",this.newHours.find((function(e){return e.type==h})).code="")},setExistHours:function(){var e,t=this,r={};this.existHours.forEach((function(o){e=t.codeDescription.find((function(e){return e.code==o.empCode})).hourType,e==f&&""!=t.newHours.find((function(t){return t.type==e})).code?void 0==t.newHours.find((function(e){return e.code==o.empCode}))?(r={type:f,hours:o.hours,code:o.empCode,week:[0,0,0,0,0,0]},r.week[o.day]=o.hours,t.newHours.push(r)):(t.newHours.find((function(e){return e.code==o.empCode})).hours+=o.hours,t.newHours.find((function(e){return e.code==o.empCode})).week[o.day]+=o.hours):(t.newHours.find((function(t){return t.type==e})).week[o.day]=o.hours,t.newHours.find((function(t){return t.type==e})).hours+=o.hours,t.newHours.find((function(t){return t.type==e})).code=o.empCode)})),this.setPrivateAndPauseCodes(this.newHours.find((function(e){return e.type==f})).code),this.sortTable()},removeRow:function(e){0!==e&&this.newHours[e].type==f&&(this.newHours.splice(e,1),this.getPauseAndPrivateHours())},addNewRow:function(){this.newHours.push({type:f,hours:0,code:"",week:[0,0,0,0,0,0]}),this.sortTable()},sortTable:function(){this.newHours.sort((function(e,t){return e.type-t.type}))},isNumber:function(e){return!isNaN(parseFloat(e))&&!isNaN(e-0)},currCodeDescription:function(e){return void 0!=e&&e>0?void 0===this.codeDescription.find((function(t){return t.code==e}))?"":this.codeDescription.find((function(t){return t.code==e})).codeDescription:""},getAllFrontalHours:function(){return this.newHours.filter((function(e){return e.type==f})).reduce((function(e,t){return e+parseInt(t.hours)}),0)},currOptionjobPercent:function(e){return void 0!=e&&e>0?void 0===this.empOptions.find((function(t){return t.frontalHours==e}))?0:this.empOptions.find((function(t){return t.frontalHours==e})).jobPercent:0},saveHours:function(){var e=this,t=!1,r=!0;return this.newHours.forEach((function(t){0!=e.validRowsHours(t)||(r=!1)})),0==r?(alert("יש למלא שעות תקינות"),!1):(this.setNewHoursForSave(),a()({url:"/teacherEmploymentDetails/saveAll",method:"post",data:this.tableToSave}).then((function(){alert("הנתונים נשמרו בהצלחה"),t=!0})).catch((function(t){e.$store.dispatch("displayErrorMessage",{error:t})})),t)},convertReformDescription:function(e){return e==p?"פרטני":e==h?"שהייה":"פרונטלי"},validRowsHours:function(e){return void 0==e.hours||e.hours==this.rowSum(e.week)},validTotalHours:function(){return this.hoursAmount()==this.tableSum()},rowSum:function(e){return e.reduce((function(e,t){return parseInt(e)+parseInt(t)}),0)},tableSum:function(){var e=this;return this.newHours.reduce((function(t,r){return parseInt(t)+e.rowSum(r.week)}),0)},hoursAmount:function(){var e=this;return this.newHours.filter((function(t){return e.isNumber(t.hours)})).reduce((function(e,t){return parseInt(e)+parseInt(t.hours)}),0)},dayAmount:function(e){return this.newHours.reduce((function(t,r){return parseInt(t)+parseInt(r.week[e])}),0)},initilizer:function(){this.newHours=[],5==this.reformType||2==this.reformType?this.newHours=[{type:f,hours:0,code:"",week:[0,0,0,0,0,0]},{type:p,hours:0,code:"",week:[0,0,0,0,0,0]},{type:h,hours:0,code:"",week:[0,0,0,0,0,0]}]:this.newHours=[{type:f,hours:0,code:"",week:[0,0,0,0,0,0]}]}},computed:{_reformDiscription:function(){var e=this,t=this.reformTypes.find((function(t){return t.reformId==e.reformType}));return void 0!=t?t.name:""},_filteredCodes:function(){var e=this;return this.codeDescription.filter((function(t){return t.hourType==f&&!e.newHours.find((function(e){return e.code==t.code}))}))}},watch:{empId:function(e){this.empId=e,this.initilizer(),this.getCodeDescription(),this.getEmployeeOptions(),this.getExistData()},reformType:function(e){this.reformType=e,this.initilizer(),this.getCodeDescription(),this.getEmployeeOptions(),this.getExistData()}}},v=m,y=(r("ee40"),r("2877")),w=r("6544"),_=r.n(w),g=r("c6a6"),H=r("8336"),I=Object(y["a"])(v,c,d,!1,null,"9449558a",null),b=I.exports;_()(I,{VAutocomplete:g["a"],VBtn:H["a"]});var x={name:"setEmployeesHours",components:{weeklyHours:b},data:function(){return{search:null,reformId:null,empId:null,tzArray:[],employeeInfo:{},existHours:[],weeklyHoursComponents:[],reformTypes:[]}},created:function(){this.getAllTz(),this.getReformTypes()},computed:{_mossadInfo:function(){if(null==this.$store.getters.mossadInfo){var e={mossadName:""};return e}return this.$store.state.mossadInfo},formatDate:function(){if(void 0!=this.employeeInfo.birthDate){var e=new Date(this.employeeInfo.birthDate),t=new Date;return t.getFullYear()-e.getFullYear()}},formatGender:function(){if(void 0!=this.employeeInfo.gender)return"M"===this.employeeInfo.gender?"זכר":"נקבה"},formatIsMother:function(){return!0===this.employeeInfo.mother?"כן":"לא"},ageHours:function(){if(void 0===this.employeeInfo.birthDate)return null;var e=new Date(this.employeeInfo.birthDate),t=new Date,r=t.getFullYear()-e.getFullYear();return r<50?0:r>55?4:2}},methods:{totalHours:function(e){return null!=e?e.reduce((function(e,t){return parseInt(e)+parseInt(t)}),0):0},getRowType:function(e){return 1===e?"במוסד":"בכל המוסדות"},getAllTz:function(){var e=this;a.a.get("/employees/all").then((function(t){e.tzArray=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getEmployeeInfo:function(){var e=this;a.a.get("/employees/byId",{params:{empId:this.empId}}).then((function(t){e.employeeInfo=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})})),this.getAllExistHours()},getAllExistHours:function(){var e=this;this.existHours=[],a.a.get("/teacherEmploymentDetails/weekSum",{params:{empId:this.empId}}).then((function(t){e.existHours.push({type:1,week:t.data})})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})})),a.a.get("/teacherEmploymentDetails/weekSumPerMossad",{params:{empId:this.empId,mossadId:this.$store.state.mossadId}}).then((function(t){e.existHours.push({type:2,week:t.data})}))},getReformTypes:function(){var e=this;a.a.get("/reformTypes/relevant").then((function(t){e.reformTypes=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},navigateToHirepage:function(){this.$router.push("/HireEmp")},getTwoDigits:function(e,t){return parseFloat(e/t*100).toFixed(2)}}},T=x,C=(r("54d1"),r("b0af")),k=r("99d9"),E=r("62ad"),D=r("0fd9"),A=r("b974"),R=Object(y["a"])(T,s,i,!1,null,"329a9a7a",null),S=R.exports;_()(R,{VAutocomplete:g["a"],VCard:C["a"],VCardText:k["b"],VCol:E["a"],VRow:D["a"],VSelect:A["a"]});var N={name:"employeeInfo",components:{setEmployeesHours:S},data:function(){return{}}},$=N,M=Object(y["a"])($,o,n,!1,null,"7c60b89b",null);t["default"]=M.exports},"3ebc":function(e,t,r){},"408a":function(e,t,r){var o=r("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=o(e))throw TypeError("Incorrect invocation");return+e}},"54d1":function(e,t,r){"use strict";var o=r("efc1"),n=r.n(o);n.a},a434:function(e,t,r){"use strict";var o=r("23e7"),n=r("23cb"),s=r("a691"),i=r("50c4"),u=r("7b0b"),a=r("65f0"),c=r("8418"),d=r("1dde"),l=r("ae40"),f=d("splice"),p=l("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,m=Math.min,v=9007199254740991,y="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!f||!p},{splice:function(e,t){var r,o,d,l,f,p,w=u(this),_=i(w.length),g=n(e,_),H=arguments.length;if(0===H?r=o=0:1===H?(r=0,o=_-g):(r=H-2,o=m(h(s(t),0),_-g)),_+r-o>v)throw TypeError(y);for(d=a(w,o),l=0;l<o;l++)f=g+l,f in w&&c(d,l,w[f]);if(d.length=o,r<o){for(l=g;l<_-o;l++)f=l+o,p=l+r,f in w?w[p]=w[f]:delete w[p];for(l=_;l>_-o+r;l--)delete w[l-1]}else if(r>o)for(l=_-o;l>g;l--)f=l+o-1,p=l+r-1,f in w?w[p]=w[f]:delete w[p];for(l=0;l<r;l++)w[l+g]=arguments[l+2];return w.length=_-o+r,d}})},b680:function(e,t,r){"use strict";var o=r("23e7"),n=r("a691"),s=r("408a"),i=r("1148"),u=r("d039"),a=1..toFixed,c=Math.floor,d=function(e,t,r){return 0===t?r:t%2===1?d(e,t-1,r*e):d(e*e,t/2,r)},l=function(e){var t=0,r=e;while(r>=4096)t+=12,r/=4096;while(r>=2)t+=1,r/=2;return t},f=a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!u((function(){a.call({})}));o({target:"Number",proto:!0,forced:f},{toFixed:function(e){var t,r,o,u,a=s(this),f=n(e),p=[0,0,0,0,0,0],h="",m="0",v=function(e,t){var r=-1,o=t;while(++r<6)o+=e*p[r],p[r]=o%1e7,o=c(o/1e7)},y=function(e){var t=6,r=0;while(--t>=0)r+=p[t],p[t]=c(r/e),r=r%e*1e7},w=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==p[e]){var r=String(p[e]);t=""===t?r:t+i.call("0",7-r.length)+r}return t};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(h="-",a=-a),a>1e-21)if(t=l(a*d(2,69,1))-69,r=t<0?a*d(2,-t,1):a/d(2,t,1),r*=4503599627370496,t=52-t,t>0){v(0,r),o=f;while(o>=7)v(1e7,0),o-=7;v(d(10,o,1),0),o=t-1;while(o>=23)y(1<<23),o-=23;y(1<<o),v(1,1),y(2),m=w()}else v(0,r),v(1<<-t,0),m=w()+i.call("0",f);return f>0?(u=m.length,m=h+(u<=f?"0."+i.call("0",f-u)+m:m.slice(0,u-f)+"."+m.slice(u-f))):m=h+m,m}})},ee40:function(e,t,r){"use strict";var o=r("3ebc"),n=r.n(o);n.a},efc1:function(e,t,r){}}]);
//# sourceMappingURL=EmployeeInfo.2ad9d324.js.map