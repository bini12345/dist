(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["EmployeeInfo"],{1148:function(e,t,r){"use strict";var o=r("a691"),s=r("1d80");e.exports="".repeat||function(e){var t=String(s(this)),r="",n=o(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r}},"13d5":function(e,t,r){"use strict";var o=r("23e7"),s=r("d58f").left,n=r("a640"),a=r("ae40"),i=n("reduce"),u=a("reduce",{1:0});o({target:"Array",proto:!0,forced:!i||!u},{reduce:function(e){return s(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1b11":function(e,t,r){},"246e":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("setEmployeesHours")],1)},s=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("div",{staticClass:"littleMargin"},[r("v-row",{attrs:{id:"mossadHoursDetails"}},[r("v-col",{attrs:{cols:"12",md:"2"}},[r("v-select",{attrs:{items:e.years,"item-text":"hebrewYear","item-value":"year",label:"שנה"},on:{change:function(t){return e.onYearChanged()}},model:{value:e.selectedYear,callback:function(t){e.selectedYear=t},expression:"selectedYear"}})],1),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("מוסד - "+e._s(e._mossadInfo.mossadName))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("שעות מאוישות - "+e._s(e._mossadInfo.currHours))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("יתרת שעות - "+e._s(e._mossadInfo.maxHours-e._mossadInfo.currHours))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v("מגבלת שעות- "+e._s(e._mossadInfo.maxHours))])]),r("v-col",{attrs:{cols:"12",md:"2"}},[r("p",[e._v(" אחוז איוש - "+e._s(e.getTwoDigits(e._mossadInfo.currHours/e._mossadInfo.maxHours*100))+"% ")])])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.mossadInfo.maxHours&&0!=e.mossadInfo.maxHours,expression:"mossadInfo.maxHours != null && mossadInfo.maxHours != 0"}]},[r("v-row",[r("v-col",{attrs:{id:"serchEmployee",cols:"12",md:"3"}},[r("v-autocomplete",{attrs:{disabled:null==e.mossadInfo.maxHours||0==e.mossadInfo.maxHours,items:e.tzArray,color:"indigo lighten-5","hide-selected":"","item-text":function(e){return e.firstName+" "+e.lastName+" - "+e.empId},"item-value":"empId",label:"תעודת זהות",placeholder:"חפש"},on:{change:function(t){return e.getEmployeeInfo()}},model:{value:e.empId,callback:function(t){e.empId=t},expression:"empId"}})],1),Object.keys(this.employeeInfo).length>0?r("v-col",{attrs:{cols:"12",md:"1"}},[r("p",[e._v("שם פרטי")]),e._v(" "+e._s(e.employeeInfo.firstName)+" ")]):e._e(),Object.keys(this.employeeInfo).length>0?r("v-col",{attrs:{cols:"12",md:"1"}},[r("p",[e._v("שם משפחה")]),e._v(" "+e._s(e.employeeInfo.lastName)+" ")]):e._e(),Object.keys(this.employeeInfo).length>0?r("v-col",{attrs:{cols:"12",md:"1"}},[r("p",[e._v("גיל")]),e._v(" "+e._s(e._getAge)+" ")]):e._e(),Object.keys(this.employeeInfo).length>0?r("v-col",{attrs:{cols:"12",md:"1"}},[r("p",[e._v("משרת אם")]),e._v(" "+e._s(e.formatIsMother)+" ")]):e._e(),Object.keys(this.employeeInfo).length>0?r("v-col",{attrs:{cols:"12",md:"1"}},[r("p",[e._v("שעות גיל")]),e._v(" "+e._s(e.ageHours)+" ")]):e._e(),Object.keys(this.empHoursTable).length>0?r("v-col",{attrs:{cols:"12",md:"4"}},[r("table",{attrs:{id:"detailsTable"}},[r("thead",[r("th"),r("th",[e._v("א")]),r("th",[e._v("ב")]),r("th",[e._v("ג")]),r("th",[e._v("ד")]),r("th",[e._v("ה")]),r("th",[e._v("ו")]),r("th",[e._v("סך שעות")]),r("th",[e._v("אחוז משרה")])]),r("tbody",e._l(e.empHoursTable,(function(t,o){return r("tr",{key:o},[r("td",[e._v(e._s(e.getRowType(t.type)))]),e._l(6,(function(o){return r("td",{key:o},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on,a=s.attrs;return[r("span",e._g(e._b({on:{mouseover:function(r){return e.changeText(t.type,o-1)}}},"span",a,!1),n),[e._v(" "+e._s(t.week[o-1].hours))])]}}],null,!0)},[r("span",[e._v(e._s(e.hoverText))])])],1)})),r("td",[e._v(e._s(t.sum))]),r("td",[e._v(e._s(e.getTwoDigits(t.jobPercent))+"%")])],2)})),0)]),r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[r("v-icon",e._g(e._b({staticClass:"mr-3 excelMDI",attrs:{large:""},on:{click:function(t){return e.exportEmployeeWeeklyHours()}}},"v-icon",s,!1),o),[e._v("mdi-file-excel-outline")])]}}],null,!1,3276872017)},[r("span",[e._v("ייצוא איוש שעות לאקסל")])])],1):e._e()],1),null!=e.empId?r("v-row",[r("v-col",{attrs:{cols:"12",md:"3"}},[r("v-select",{attrs:{items:e.reformTypes,"item-text":"name","item-value":"reformId",label:"בחר רפורמה",multiple:"","single-line":""},model:{value:e.selectedReforms,callback:function(t){e.selectedReforms=t},expression:"selectedReforms"}})],1)],1):e._e(),null!=e.employeeInfo&&null!=e.selectedReforms?r("v-card",e._l(e.selectedReforms,(function(t,o){return r("v-card",{key:o},[r("weeklyHours",{attrs:{empId:e.empId,reformType:t,isMother:e.employeeInfo.mother,ageHours:e.ageHours,selectedYear:e.selectedYear,codeDescription:e.getRelevantCodesDescription(t)}})],1)})),1):e._e()],1)],1)])},a=[],i=(r("4de4"),r("7db0"),r("4160"),r("caad"),r("13d5"),r("b680"),r("2532"),r("159b"),r("96cf"),r("1da1")),u=r("bc3a"),c=r.n(u),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!=e.empId?r("div",{staticClass:"reformTypeTables"},[r("h1",{staticClass:"center"},[e._v(e._s(e._reformDiscription))]),e._l(e.tablesArray,(function(t,o){return r("div",{key:o},[r("v-row",[r("v-col",{attrs:{cols:"12",md:"2"}},[r("v-text-field",{attrs:{label:"מתאריך",type:"date",min:e.datesRange.min,max:e.datesRange.max},on:{change:function(r){return e.setDatesIfChange(t)}},model:{value:t.begda,callback:function(r){e.$set(t,"begda",r)},expression:"table.begda"}},[e._v("מתאריך")])],1),r("v-col",{attrs:{cols:"12",md:"2"}},[r("v-text-field",{attrs:{label:"עד תאריך",type:"date",min:e.datesRange.min,max:e.datesRange.max},on:{change:function(r){return e.setDatesIfChange(t)}},model:{value:t.endda,callback:function(r){e.$set(t,"endda",r)},expression:"table.endda"}},[e._v("עד תאריך")])],1),r("v-col",{attrs:{cols:"12",md:"8"}},[r("weeklyHoursTable",{staticClass:"center",attrs:{empId:e.empId,reformType:e.reformType,isMother:e.isMother,ageHours:e.ageHours,existData:t.data,begda:t.begda,endda:t.endda,codeDescription:e.codeDescription}})],1)],1)],1)}))],2):e._e()},l=[],f=(r("b0c0"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!=e.empId?r("div",[r("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.reformType,expression:"reformType != 0"}]},[r("table",{attrs:{id:"t01"}},[e._m(0),r("tbody",[e._l(e.newHours,(function(t,o){return r("tr",{key:o},[r("td",[r("div",{attrs:{id:"additionalActions"}},[t.type==e.frontalConst?r("v-icon",{attrs:{id:"myPlusIcon"},on:{click:function(t){return e.addNewRow()}}},[e._v("mdi-plus")]):e._e(),t.type==e.frontalConst&&0!=o?r("v-icon",{attrs:{id:"myMinusIcon"},on:{click:function(t){return e.removeRow(o)}}},[e._v("mdi-minus")]):e._e()],1)]),r("td",[e._v(e._s(e.convertReformDescription(t.type)))]),r("td",[t.type==e.frontalConst?r("v-select",{staticClass:"mySelectOption",attrs:{items:e.frontalCodes,"hide-selected":"","item-text":function(e){return e.code+" - "+e.codeDescription},"item-value":"code"},on:{change:function(r){return e.setPrivateAndPauseCodes(t.code)}},model:{value:t.code,callback:function(r){e.$set(t,"code",r)},expression:"row.code"}}):e._e(),t.type!=e.frontalConst?r("span",[e._v(e._s(e.currCodeDescription(t.code)))]):e._e()],1),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.hours,expression:"row.hours"}],attrs:{id:"hours",type:"number",min:"0",step:"0.1",disabled:t.code<=0||t.type!=e.frontalConst},domProps:{value:t.hours},on:{input:[function(r){r.target.composing||e.$set(t,"hours",r.target.value)},function(t){return e.getPauseAndPrivateHours()}]}})]),r("td",{staticClass:"disableStyle"}),e._l(t.week,(function(o,s){return r("td",{key:s},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.week[s],expression:"row.week[index2]"}],attrs:{type:"number",min:"0",step:"0.1",disabled:t.hours<=0},domProps:{value:t.week[s]},on:{input:function(r){r.target.composing||e.$set(t.week,s,r.target.value)}}})])})),r("td",{staticClass:"disableStyle",style:{color:0==e.validRowsHours(t)?"red":"inherit"}},[e._v(" "+e._s(e.getTwoDigits(e.leftHours(t)))+" ")])],2)})),r("tr",{staticClass:"summaryRow"},[r("td"),r("td",[e._v("סך")]),r("td",[e._v("--")]),r("td",[e._v(e._s(e.hoursAmount()))]),r("td",[e._v(" "+e._s(e.getTwoDigits(this.calcJobPercent(this.reformType,this.hoursAmount(),this.ageHours,this.isMother)))+"% ")]),e._l(parseInt(6),(function(t,o){return r("td",{key:o},[e._v(" "+e._s(e.dayAmount(t-1))+" ")])})),r("td",{style:{color:0==e.validTotalHours()?"red":"inherit"}},[e._v(" "+e._s(e.getTwoDigits(e.leftTableHours()))+" ")])],2)],2)]),r("v-btn",{staticClass:"myBtn",attrs:{color:"primary"},on:{click:function(t){return e.saveHours()}}},[e._v("שמור שעות")]),r("v-btn",{staticClass:"myBtn",attrs:{color:""},on:{click:function(t){return e.cleanWeeklyData()}}},[e._v("נקה")])],1)]):e._e()}),h=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th"),r("th",[e._v("סוג")]),r("th",[e._v("קוד פיצול")]),r("th",[e._v("שעות")]),r("th",[e._v("אחוז משרה")]),r("th",[e._v("א'")]),r("th",[e._v("ב'")]),r("th",[e._v("ג'")]),r("th",[e._v("ד'")]),r("th",[e._v("ה'")]),r("th",[e._v("ו'")]),r("th",[e._v("הפרש")])])])}],m=(r("a434"),r("56d7")),p={data:function(){return{}},methods:{calcJobPercent:function(e,t,r,o){return 0==t?0:1==e||7==e?this.getOlamYashanJobPercent(r,o,t):2==e?this.getOfekHasashJobPercent(r,o,t):5==e?this.getOzLetmuraJobPercent(r,o,t):8==e?this.getMinhalaJobPercent(r,o,t):void 0},getOlamYashanJobPercent:function(e,t,r){var o=0,s=24;return s-=e,o=r/s*100,t&&(o*=1.1),o},getOfekHasashJobPercent:function(e,t,r){var o=0,s=36;return s-=e,t&&(s-=2),o=r/s*100,o},getOzLetmuraJobPercent:function(e,t,r){var o=0,s=40;return s-=e,o=r/s*100,t&&(o*=1.07),o},getMinhalaJobPercent:function(e,t,r){var o=0,s=20;return o=r/s*100,o}}},g=1,v=2,y=3,b={name:"weeklyHours",props:["empId","reformType","isMother","ageHours","existData","begda","endda","codeDescription"],data:function(){return{newHours:[],tableBegda:"",tableEndda:"",datesRange:{min:"",max:""},tableToSave:[],tablesArray:[],empOptions:[],reformTypes:[],frontalCodes:[],existHours:[],frontalConst:g}},created:function(){this.initilizer(),this.setFrontalCodes(),this.setBegdaEndda(),this.getEmployeeOptions(),this.getExistData()},methods:{getPauseAndPrivateHours:function(){if(2==this.reformType||5==this.reformType){var e=Math.round(this.newHours.filter((function(e){return e.type==g})).reduce((function(e,t){return e+parseFloat(t.hours)}),0));e<=0||(this.newHours.find((function(e){return e.type==y})).hours=this.empOptions.find((function(t){return t.frontalHours==e})).pauseHours,this.newHours.find((function(e){return e.type==v})).hours=this.empOptions.find((function(t){return t.frontalHours==e})).privateHours)}},getEmployeeOptions:function(){var e=this;c.a.get("/calcHours/options",{params:{reformType:this.reformType,empId:this.empId}}).then((function(t){e.empOptions=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getExistData:function(){var e=this;c.a.get("/teacherEmploymentDetails/byReform",{params:{empId:this.empId,mossadId:this.$store.state.logginAuth,reformType:this.reformType,begda:this.FormatDate(this.begda),endda:this.FormatDate(this.endda)}}).then((function(t){e.existHours=t.data,null!=e.existHours&&e.setExistHours()})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},setNewHoursForSave:function(){var e=this;this.tableToSave=[],this.newHours.forEach((function(t){t.week.forEach((function(r,o){e.tableToSave.push({empId:e.empId,mossadId:e.$store.state.logginAuth,changedBy:e.$store.state.username,empCode:t.code,begda:new Date(e.tableBegda),endda:new Date(e.tableEndda),day:o,hours:r})}))}))},setPrivateAndPauseCodes:function(e){2!=this.reformType&&5!=this.reformType||""==e||(5==this.reformType?(this.newHours.find((function(e){return e.type==v})).code=9601,this.newHours.find((function(e){return e.type==y})).code=9602):2==this.reformType&&(this.newHours.find((function(e){return e.type==y})).code=5468,this.newHours.find((function(e){return e.type==v})).code=5467))},setExistHours:function(){var e,t=this,r={};this.existHours.forEach((function(o){e=t.codeDescription.find((function(e){return e.code==o.empCode})).hourType,e==g&&""!=t.newHours.find((function(t){return t.type==e})).code?void 0==t.newHours.find((function(e){return e.code==o.empCode}))?(r={type:g,hours:o.hours,code:o.empCode,week:[0,0,0,0,0,0]},r.week[o.day]=o.hours,t.newHours.push(r)):(t.newHours.find((function(e){return e.code==o.empCode})).hours+=o.hours,t.newHours.find((function(e){return e.code==o.empCode})).week[o.day]+=o.hours):(t.newHours.find((function(t){return t.type==e})).week[o.day]=o.hours,t.newHours.find((function(t){return t.type==e})).hours+=o.hours,t.newHours.find((function(t){return t.type==e})).code=o.empCode)})),this.setPrivateAndPauseCodes(this.newHours.find((function(e){return e.type==g})).code),this.sortTable()},removeRow:function(e){0!==e&&this.newHours[e].type==g&&(this.newHours.splice(e,1),this.getPauseAndPrivateHours())},addNewRow:function(){this.newHours.push({type:g,hours:0,code:"",week:[0,0,0,0,0,0]}),this.sortTable()},sortTable:function(){this.newHours.sort((function(e,t){return e.type-t.type}))},setBegdaEndda:function(){this.tableBegda=this.FormatDate(this.begda),this.tableEndda=this.FormatDate(this.endda)},FormatDate:function(e){var t,r=new Date(e),o=r.getFullYear(),s=0,n=0;return s+=r.getMonth()+1,s<10&&(s="0"+s),r.getDate()<10&&(n="0"),n+=r.getDate(),t=o+"-"+s+"-"+n,t},isNumber:function(e){return!isNaN(parseFloat(e))&&!isNaN(e-0)},getTwoDigits:function(e){return isNaN(e)||0==e?0:parseFloat(e).toFixed(2)},currCodeDescription:function(e){return void 0!=e&&e>0?void 0===this.codeDescription.find((function(t){return t.code==e}))?"":this.codeDescription.find((function(t){return t.code==e})).codeDescription:""},getAllFrontalHours:function(){return this.newHours.filter((function(e){return e.type==g})).reduce((function(e,t){return e+parseFloat(t.hours)}),0)},saveHours:function(){var e=this,t=!0;if(this.newHours.forEach((function(r){0!=e.validRowsHours(r)||(t=!1)})),0==t)return alert("יש למלא שעות תקינות"),!1;this.setNewHoursForSave(),c()({url:"/teacherEmploymentDetails/saveAll",method:"post",data:this.tableToSave}).then((function(){alert("הנתונים נשמרו בהצלחה"),m["bus"].$emit("changeWeeklyHours")})).catch((function(t){e.$store.dispatch("displayErrorMessage",{error:t})}))},convertReformDescription:function(e){return e==v?"פרטני":e==y?"שהייה":"פרונטלי"},validRowsHours:function(e){return void 0==e.hours||0==this.leftHours(e)},validTotalHours:function(){return 0==this.leftTableHours()},leftHours:function(e){var t=e.week;return parseFloat(t.reduce((function(e,t){return parseFloat(e)+parseFloat(t)}),0))-e.hours},leftTableHours:function(){var e=this;return this.newHours.reduce((function(t,r){return parseFloat(t)+e.leftHours(r)}),0)},hoursAmount:function(){var e=this;return this.newHours.filter((function(t){return e.isNumber(t.hours)})).reduce((function(e,t){return parseFloat(e)+parseFloat(t.hours)}),0)},dayAmount:function(e){return this.newHours.reduce((function(t,r){return parseFloat(t)+parseFloat(r.week[e])}),0)},initilizer:function(){this.newHours=[],5==this.reformType||2==this.reformType?this.newHours=[{type:g,hours:0,code:"",week:[0,0,0,0,0,0]},{type:v,hours:0,code:"",week:[0,0,0,0,0,0]},{type:y,hours:0,code:"",week:[0,0,0,0,0,0]}]:this.newHours=[{type:g,hours:0,code:"",week:[0,0,0,0,0,0]}]},cleanWeeklyData:function(){this.newHours.forEach((function(e){e.hours=0,e.week=[0,0,0,0,0,0]}))},setFrontalCodes:function(){var e=this;this.frontalCodes=this.codeDescription.filter((function(t){return(t.hourType==g||0==t.hourType)&&!e.newHours.find((function(e){return e.code==t.code}))}))}},watch:{empId:function(e){this.empId=e,this.initilizer(),this.setFrontalCodes(),this.getEmployeeOptions()},reformType:function(e){this.reformType=e,this.initilizer(),this.setFrontalCodes(),this.getEmployeeOptions()}},mixins:[p]},w=b,H=(r("5ae9"),r("2877")),_=r("6544"),I=r.n(_),D=r("8336"),T=r("132d"),x=r("b974"),E=Object(H["a"])(w,f,h,!1,null,"69f4efc2",null),k=E.exports;I()(E,{VBtn:D["a"],VIcon:T["a"],VSelect:x["a"]});var F={name:"weeklyHours",props:["empId","reformType","isMother","ageHours","selectedYear","codeDescription"],components:{weeklyHoursTable:k},data:function(){return{datesRange:{min:"",max:""},tablesArray:[],reformTypes:[],existHours:[]}},created:function(){this.getReformTypes(),this.setBegdaEndda(),this.getExistData()},methods:{getExistData:function(){var e=this;c.a.get("/teacherEmploymentDetails/byReform",{params:{empId:this.empId,mossadId:this.$store.state.logginAuth,reformType:this.reformType,begda:this.FormatDate(this.datesRange.min),endda:this.FormatDate(this.datesRange.max)}}).then((function(t){e.existHours=t.data,e.gruopByBegdaEndda()})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},gruopByBegdaEndda:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.existHours.forEach((function(t){var r=e.tablesArray.find((function(r){return r.begda==e.FormatDate(t.begda)&&r.endda==e.FormatDate(t.endda)}));null!=r?r.data.push(t):e.tablesArray.push({begda:e.FormatDate(t.begda),endda:e.FormatDate(t.endda),data:[t]})}));case 2:e.setDefualtValues();case 3:case"end":return t.stop()}}),t)})))()},getReformTypes:function(){var e=this;c.a.get("/reformTypes/relevant").then((function(t){e.reformTypes=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},setBegdaEndda:function(){this.datesRange.min=new Date(this.selectedYear-1,8,1),this.datesRange.max=new Date(this.selectedYear,5,20)},setDefualtValues:function(){0==this.tablesArray.length&&this.tablesArray.push({begda:this.FormatDate(this.datesRange.min),endda:this.FormatDate(this.datesRange.max),data:{}})},addWeeklHoursTable:function(){var e=new Date(this.tablesArray.reduce((function(e,t){return e.endda>t.endda?e:t})).endda);e.setDate(e.getDate()+1),e<this.datesRange.max?this.tablesArray.push({begda:this.FormatDate(e),endda:this.FormatDate(this.datesRange.max),data:{}}):alert("אין אפשרות ליצור יותר מרושמה אחת על תאריכים חופפים")},removeWeeklHoursTable:function(){this.tablesArray.pop()},setDatesIfChange:function(e){(e.endda>this.FormatDate(this.datesRange.max)||e.endda<this.FormatDate(this.datesRange.min))&&(e.endda=this.FormatDate(this.datesRange.max)),(e.begda>this.FormatDate(this.datesRange.max)||e.begda<this.FormatDate(this.datesRange.min))&&(e.begda=this.FormatDate(this.datesRange.min))},FormatDate:function(e){var t,r=new Date(e),o=r.getFullYear(),s=0,n=0;return s+=r.getMonth()+1,s<10&&(s="0"+s),r.getDate()<10&&(n="0"),n+=r.getDate(),t=o+"-"+s+"-"+n,t}},computed:{_reformDiscription:function(){var e=this,t=this.reformTypes.find((function(t){return t.reformId==e.reformType}));return void 0!=t?t.name:""}},watch:{empId:function(e){this.empId=e,this.getExistData()},reformType:function(e){this.reformType=e,this.getExistData()},selectedYear:function(e){this.selectedYear=e,this.tablesArray=[],this.setBegdaEndda(),this.getExistData()}}},R=F,C=(r("969f"),r("62ad")),A=r("0fd9"),M=r("8654"),Y=Object(H["a"])(R,d,l,!1,null,"2d072982",null),$=Y.exports;I()(Y,{VCol:C["a"],VRow:A["a"],VTextField:M["a"]});var P=r("87cf"),O={name:"setEmployeesHours",components:{weeklyHours:$},data:function(){return{search:null,selectedReforms:null,selectedYear:2021,empId:null,ageHours:0,tzArray:[],datesRange:{min:"",max:""},employeeInfo:{},existHours:[],existData:[],reformTypes:[],codeDescription:[],empHoursTable:[],mossadot:[],mossadInfo:{},hoverText:""}},created:function(){this.initilize(),this.getAllTz(),this.getCodeDescription(),this.getMossadot(),this.getReformTypes(),this.setBegdaEndda(),this.getMossadHours()},mounted:function(){var e=this;m["bus"].$on("changeWeeklyHours",Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getAllEmpData(),t.next=3,e.getMossadHours();case 3:case"end":return t.stop()}}),t)}))))},computed:{_getAge:function(){var e=new Date,t=new Date(this.employeeInfo.birthDate),r=0,o=e.getFullYear()-t.getFullYear();return e.getUTCMonth()<t.getUTCMonth()&&(o-=1),r=e.getUTCMonth()-t.getUTCMonth(),r<0&&(r*=-1),r<10&&(r="0"+r),o+"."+r},formatGender:function(){if(void 0!=this.employeeInfo.gender)return"M"===this.employeeInfo.gender?"זכר":"נקבה"},formatIsMother:function(){return!0===this.employeeInfo.mother?"כן":"לא"},_getAgeHours:function(){if(void 0===this.employeeInfo.birthDate)return null;var e=new Date(this.employeeInfo.birthDate),t=new Date,r=new Date(t.getFullYear(),8,1);t.getMonth()>=8&&r.setFullYear(r.getFullYear()+1);var o=r.getFullYear()-e.getFullYear();return o<50?0:o>55?4:2},_mossadInfo:function(){return this.mossadInfo}},methods:{initilize:function(){this.mossadInfo.mossadId=this.$store.state.mossadId,this.mossadInfo.mossadName=this.$store.state.mossadInfo.mossadName,this.years=[{year:2021,hebrewYear:'תשפ"א'},{year:2022,hebrewYear:'תשפ"ב'},{year:2023,hebrewYear:'תשפ"ג'},{year:2024,hebrewYear:'תשפ"ד'},{year:2025,hebrewYear:'תשפ"ה'}]},onYearChanged:function(){this.initilize(),this.getAllTz(),this.setBegdaEndda(),this.getAllEmpData(),this.getMossadHours()},getAllTz:function(){var e=this;c.a.get("/employees/all").then((function(t){e.tzArray=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getEmployeeInfo:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c.a.get("/employees/byId",{params:{empId:e.empId}}).then((function(t){e.employeeInfo=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}));case 2:e.calcAgeHours(),e.getAllEmpData();case 4:case"end":return t.stop()}}),t)})))()},getMossadHours:function(){var e=this;this.mossadInfo.currHours=0,this.mossadInfo.maxHours=0,c.a.get("mossadHours/byId",{params:{mossadId:this.$store.state.logginAuth,year:this.selectedYear}}).then((function(t){e.mossadInfo.currHours=t.data.currHours,e.mossadInfo.maxHours=t.data.maxHours})).catch((function(){alert("לא נמצאו נתונים עבור מוסד בשנה זו בחר שנה אחרת או הוסף שעות למוסד")}))},getReformTypes:function(){var e=this;c.a.get("/reformTypes/relevant").then((function(t){e.reformTypes=t.data,e.filterReformTypeByMossad()})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getCodeDescription:function(){var e=this;c.a.get("/convertHours/all").then((function(t){e.codeDescription=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},getAllEmpData:function(){var e=this;null!=this.empId&&""!=this.empId&&c.a.get("/teacherEmploymentDetails/byId",{params:{empId:this.empId,begda:this.datesRange.min,endda:this.datesRange.max}}).then((function(t){e.existData=t.data,e.calcEmpHoursData()})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},setBegdaEndda:function(){this.datesRange.min=this.formatDate(new Date(this.selectedYear-1,8,1)),this.datesRange.max=this.formatDate(new Date(this.selectedYear,5,20))},formatDate:function(e){var t,r=new Date(e),o=r.getFullYear(),s=0,n=0;return s+=r.getMonth()+1,s<10&&(s="0"+s),r.getDate()<10&&(n="0"),n+=r.getDate(),t=o+"-"+s+"-"+n,t},exportEmployeeWeeklyHours:function(){this.createWeeklyHoursToEmployee(this.empId,this.$store.state.logginAuth,this.datesRange.min,this.datesRange.max)},filterReformTypeByMossad:function(){2==this.$store.state.mossadInfo.mossadType?this.reformTypes=this.reformTypes.filter((function(e){return 1==e.reformId||5==e.reformId||7==e.reformId||2==e.reformId||8==e.reformId})):1==this.$store.state.mossadInfo.mossadType&&(this.reformTypes=this.reformTypes.filter((function(e){return 1==e.reformId||5==e.reformId||8==e.reformId}))),this.reformTypes.filter},getTwoDigits:function(e){return isNaN(e)?"":parseFloat(e).toFixed(2)},changeText:function(e,t){this.hoverText=this.getMossadotDescription(this.empHoursTable[e].week[t].mossadot)},getMossadotDescription:function(e){var t=this;if(null==e)return"";var r="";return e.forEach((function(e){r+=t.mossadot.find((function(t){return t.mossadId==e})).mossadName+", "})),r},getRelevantCodesDescription:function(e){return this.codeDescription.filter((function(t){return t.reformType==e}))},getMossadot:function(){var e=this;c.a.get("mossadot/all").then((function(t){return e.mossadot=t.data})).catch((function(t){return e.$store.dispatch("displayErrorMessage",{error:t})}))},calcAgeHours:function(){void 0===this.employeeInfo.birthDate&&(this.ageHours=0);var e=new Date(this.employeeInfo.birthDate),t=new Date,r=new Date(t.getFullYear(),8,1);t.getMonth()>=8&&r.setFullYear(r.getFullYear()+1);var o=r.getFullYear()-e.getFullYear();this.ageHours=o<50?0:o>55?4:2},totalHours:function(e){if(null!=e){for(var t=0,r=0;r<6;r++)t+=parseFloat(e[r]);return t}return 0},getRowType:function(e){return 0===e?"במוסד":"בכל המוסדות"},calcEmpHoursData:function(){var e=this;this.empHoursTable=[{week:[],sum:0,jobPercent:0,type:0},{week:[],sum:0,jobPercent:0,type:1}];for(var t=0;t<6;t++)this.empHoursTable[0].week.push({day:t,hours:0,mossadot:[this.$store.state.logginAuth]}),this.empHoursTable[1].week.push({day:t,hours:0,mossadot:[]});this.existData.forEach((function(t){t.mossadId==e.$store.state.logginAuth&&(e.empHoursTable[0].week[t.day].hours+=t.hours,e.empHoursTable[0].sum+=t.hours),e.empHoursTable[1].week[t.day].hours+=t.hours,e.empHoursTable[1].sum+=t.hours,e.empHoursTable[1].week[t.day].mossadot.includes(t.mossadId)||e.empHoursTable[1].week[t.day].mossadot.push(t.mossadId)})),this.reformTypes.forEach((function(t){var r=e.existData.filter((function(r){return r.reformType==t.reformId&&r.mossadId==e.$store.state.logginAuth})).reduce((function(e,t){return e+parseFloat(t.hours)}),0);e.empHoursTable[0].jobPercent+=e.calcJobPercent(t.reformId,r,e.ageHours,e.employeeInfo.mother);var o=e.existData.filter((function(e){return e.reformType==t.reformId})).reduce((function(e,t){return e+parseFloat(t.hours)}),0);e.empHoursTable[1].jobPercent+=e.calcJobPercent(t.reformId,o,e.ageHours,e.employeeInfo.mother)}))}},mixins:[P["a"],p]},N=O,B=(r("f3d6"),r("c6a6")),S=r("b0af"),j=r("3a2f"),z=Object(H["a"])(N,n,a,!1,null,"2212ec49",null),V=z.exports;I()(z,{VAutocomplete:B["a"],VCard:S["a"],VCol:C["a"],VIcon:T["a"],VRow:A["a"],VSelect:x["a"],VTooltip:j["a"]});var J={name:"employeeInfo",components:{setEmployeesHours:V},data:function(){return{}}},W=J,U=Object(H["a"])(W,o,s,!1,null,"d08aab0a",null);t["default"]=U.exports},2532:function(e,t,r){"use strict";var o=r("23e7"),s=r("5a34"),n=r("1d80"),a=r("ab13");o({target:"String",proto:!0,forced:!a("includes")},{includes:function(e){return!!~String(n(this)).indexOf(s(e),arguments.length>1?arguments[1]:void 0)}})},"408a":function(e,t,r){var o=r("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=o(e))throw TypeError("Incorrect invocation");return+e}},"44e7":function(e,t,r){var o=r("861d"),s=r("c6b6"),n=r("b622"),a=n("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==s(e))}},"47ed":function(e,t,r){},"5a34":function(e,t,r){var o=r("44e7");e.exports=function(e){if(o(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5ae9":function(e,t,r){"use strict";var o=r("47ed"),s=r.n(o);s.a},6015:function(e,t,r){},"969f":function(e,t,r){"use strict";var o=r("6015"),s=r.n(o);s.a},ab13:function(e,t,r){var o=r("b622"),s=o("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[s]=!1,"/./"[e](t)}catch(o){}}return!1}},b680:function(e,t,r){"use strict";var o=r("23e7"),s=r("a691"),n=r("408a"),a=r("1148"),i=r("d039"),u=1..toFixed,c=Math.floor,d=function(e,t,r){return 0===t?r:t%2===1?d(e,t-1,r*e):d(e*e,t/2,r)},l=function(e){var t=0,r=e;while(r>=4096)t+=12,r/=4096;while(r>=2)t+=1,r/=2;return t},f=u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!i((function(){u.call({})}));o({target:"Number",proto:!0,forced:f},{toFixed:function(e){var t,r,o,i,u=n(this),f=s(e),h=[0,0,0,0,0,0],m="",p="0",g=function(e,t){var r=-1,o=t;while(++r<6)o+=e*h[r],h[r]=o%1e7,o=c(o/1e7)},v=function(e){var t=6,r=0;while(--t>=0)r+=h[t],h[t]=c(r/e),r=r%e*1e7},y=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==h[e]){var r=String(h[e]);t=""===t?r:t+a.call("0",7-r.length)+r}return t};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(m="-",u=-u),u>1e-21)if(t=l(u*d(2,69,1))-69,r=t<0?u*d(2,-t,1):u/d(2,t,1),r*=4503599627370496,t=52-t,t>0){g(0,r),o=f;while(o>=7)g(1e7,0),o-=7;g(d(10,o,1),0),o=t-1;while(o>=23)v(1<<23),o-=23;v(1<<o),g(1,1),v(2),p=y()}else g(0,r),g(1<<-t,0),p=y()+a.call("0",f);return f>0?(i=p.length,p=m+(i<=f?"0."+a.call("0",f-i)+p:p.slice(0,i-f)+"."+p.slice(i-f))):p=m+p,p}})},caad:function(e,t,r){"use strict";var o=r("23e7"),s=r("4d64").includes,n=r("44d2"),a=r("ae40"),i=a("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!i},{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")},f3d6:function(e,t,r){"use strict";var o=r("1b11"),s=r.n(o);s.a}}]);
//# sourceMappingURL=EmployeeInfo.04e64dcc.js.map